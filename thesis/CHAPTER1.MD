# Структура базы данных #

## Основная терминология ## 

_«данные»_ обычно относится к информации уже записанной или той, которую можно записать
_Таблица_ — один из самых простых инструментов, используемых для записи и визуализации данных

![table_1.png](../img/c1/table_1.png)

Все базы данных содержат _метаданные_, то есть данные, описывающие структуру и форматирование самих данных,
часто называемые «данными о данных». Например, поле DateOfBirth (дата рождения) может содержать метаданные, которые
преобразовывают информацию к формату мм/дд/гггг. Метаданные, содержащиеся в поле Height
(рост), могут ограничивать длину данных двумя знаками, если рост измеряется в дюймах.

Термин «база данных» можно определить как совокупность данных, упорядоченных для упрощения и скорости поиска.
Как правило, информация внутри базы данных хранится в виде набора таблиц.
Каждая таблица содержит определенные наборы данных, которые могут быть взаимосвязаны с другими данными из других таблиц
и ссылаться на них.

Роль базы данных — упростить взаимодействие, организацию и анализ связанных данных из различных источников. Данные
сохраняются во взаимосвязанных таблицах, что дает возможность манипулировать ими более гибко

![table_structure.png](../img/c1/table_structure.png)

База данных состоит из таблиц. Таблицы состоят из записей.

_Строки_ в таблице называются _записями_. Также их можно называть _кортежами_. Столбцы в таблице, как правило,
называются _полями_. Также их можно назвать _атрибутами_. Поля/атрибуты — это категории, используемые для определения
данных в записи (строке).

Каждая запись разбита на несколько полей, представляющих собой отдельные элементы данных, которые описывают конкретный
элемент.

![table_elements.png](../img/c1/table_elements.png)

## Основные элементы реляционных баз данных ## 

Реляционная модель базы данных наиболее распространенная форма проектирования баз данных.

В реляционных базах, таблицы связаны друг с другом с помощью ключевых полей являющиеся первичным ключом.
Каждая таблица в реляционной базе данных должна содержать **_первичный ключ_**. Первичный ключ — это уникальный
идентификатор записи в таблице. Первичный ключ каждой записи должен быть уникальным и не должен быть нулевым (пустым).

В реляционной базе данных таблицы часто называют «связями», так как они содержат набор записей (строк), связанных с
различными полями (столбцами).

_**Внешний ключ**_ — это поле в таблице, значение которого соответствует первичному ключу в другой таблице.
Именно совпадение различных ключевых полей в разных таблицах обеспечивает исключительно важную взаимосвязь в реляционной
базе данных. Как правило, эти связи отображаются в виде _схемы_ базы данных, также известной как _диаграмма «сущность —
связь»_ (_ERD, Entity Relationship Diagram_), которая служит своего рода эскизом для базы данных.

![scheme_entity_relations.png](../img/c1/scheme_entity_relations.png)

В данной схеме всего четыре таблицы, и таблицы связаны друг с другом посредством одного или нескольких общих полей. Поле
`PatientID` — это первичный ключ для таблицы `patient_info` и одновременно внешний ключ для таблицы `lab_orders`. Точно
так
же поле `HospitalId` — первичный ключ для таблицы `hospitals`, но это внешний ключ для таблицы `primary_care_doctors`.

Рисунок выше описывает базу данных для обработки заказов и доставки товаров клиентам. Символы 1 и ∞, которые находятся
на схеме на концах соединительных линий описывают связи между таблицами. Когда на одном конце соединительной линии
находится символ 1, а на другом — символ ∞, это означает связь между полями таблиц «один-ко-многим».
Значок ключа, расположенный рядом с полем LabOrderNo, ParentId, HospitalId, primary_care_doctor означает, что данное
поле — это первичный ключ для данной таблицы.

![composite_key.png](../img/c1/composite_key.png)

Таблица `order_details` из примера выше имеет два первичных ключа (обозначено значками
ключей). Можно трактовать это как _составной ключ_, то есть для определения первичного ключа используются два или более
поля. Хотя технически в примере задействовано два ключа, стоит рассматривать их как единый элемент — собственно
первичный ключ. Комбинация данных в полях, используемая для формирования составного ключа, работает как уникальный
идентификатор для любой записи в таблице.

## Типы данных ## 

При разработке базы данных с использованием SQL для каждого используемого столбца должен быть назначен определенный _тип
данных_. Типы данных могут незначительно отличаться в зависимости от используемой версии SQL. Однако, как правило,
у вас будут числовые, символьные или текстовые типы данных, дата и время, а также логические значения.

### Числовые типы данных ###

В состав _числовых_ данных входят целочисленные данные, которые служат для отображения **целых чисел**. Обычно, когда
используется целочисленный тип данных, он имеет ограничения на длину для экономии памяти.

Когда целочисленные данные не подходят и возникает необходимость в более точном числовом формате, мы можем использовать
формат чисел с _плавающей запятой_. Как и целочисленные данные, они могут быть ограничены по длине.
SQL также допускает денежные (финансовые) типы данных.

### Символьные, или текстовые, типы данных ###

_Символьные_, или _текстовые_, типы данных (еще их называют «строковые») могут хранить строки символов как
фиксированной,
так и переменной длины. Многие базы данных содержат текстовые поля, позволяющие хранить гораздо более длинные строки
текста. Некоторые структуры баз данных позволяют каталогизировать многостраничные тексты или даже целые книги.

### Дата и время ### 

_Дата и время_ — эти данные важны во многих случаях. SQL предлагает пользователям различные форматы даты и времени:
YYYY-MM-DD (ГГГГ-ММ-ДД), YYYY-MM-DD HH:MI:SS (ГГГГ-ММ-ДД ЧЧ:МИ:СС), YY-MM-DD (ГГ-ММДД). Вы также можете отформатировать
столбец так, чтобы он содержал только год, в четырех- или двухзначном формате. В SQL форматы даты/времени содержат
встроенные числовые значения, позволяющие базе данных обрабатывать запросы, где в качестве условия задан интервал
времени.

### Логический тип данных ###

_Логические значения_ — это данные, принимающие значения True (Правда) или False (Ложь).

В разных версиях SQL — разные списки распознаваемых типов данных. Некоторые версии SQL, такие, как SQL Server и MySQL
не дают пользователю возможности присвоить данным тип Boolean. Вместо этого они предоставляют тип данных Bit, который
может быть легко преобразован в логический формат.

## Системы управления реляционными базами данных ##

SQL применяется в целом ряде программных пакетов, известных как реляционные системы управления базами данных (РСУБД).
Эти системы упрощают применение SQL, когда пользователь дает команды и задает вопросы базе данных.
Наиболее распространенные СУБД — это PostgreSQL, Oracle Database, Microsoft SQL Server, MySQL, IBM Db2 и SQLite.

Тот факт, что мы сообщаем РСУБД, какую информацию нам предоставлять, определяет SQL как декларативный язык
программирования. Это отличает его от таких языков программирования, как C++, Java и т. д. Они являются более
процедурными, так как с их помощью программа создается от начала до конца (распределяется память, в том числе для
существующих справочных файлов, и т. д.). В случае SQL все распределение памяти и другие действия выполняются РСУБД.

## Оператор SELECT ##

`SELECT` — самая распространенная команда SQL.
SQL-запрос обычно состоит из оператора SELECT в сочетании с другими операторами SQL и ссылок на данные, участвующие в
запросе. Как и в случае с другими языками программирования, правильная последовательность и выбор операторов SQL важны
для создания запроса, который будет правильно интерпретирован браузером SQL. Эта строго заданная структура называется
_синтаксисом_ запроса.

Синтаксис запроса может несколько отличатся в различных реализациях РСУБД.
**SQL Server**

```tsql
SELECT TOP 10 *
FROM products;
```

```mysql
SELECT *
FROM products
LIMIT 10;
```

Это два очень простых запроса, которые по сути делают одно и то же (возвращают первые десять записей из таблицы
products), но сформулированы они немного по-разному. Единственное различие между этими двумя реализациями SQL
заключается в том, каким образом мы указываем браузеру SQL ограничить наши результаты десятью первыми записями.
В остальном запросы одинаковы. Различия между РСУБД обычно весьма незначительны. Если выражать в процентах, то эти
различия составляют менее 10%. Простые декларативные принципы SQL работают в большинстве РСУБД.

### Запросы, операторы, условия и ключевые слова ###

SELECT — это специальное ключевое слово в SQL, также его называют оператором SELECT, условием SELECT или запросом
SELECT. 
_Запрос_ — это набор команд, который возвращает информацию из базы данных в виде записей. Запрос может состоять из
нескольких операторов SQL. Оператор SQL — это выполняемый РСУБД любой допустимый фрагмент кода.
Условие — это часть запроса, содержащая по крайней мере одно ключевое слово и соответствующую информацию, 
которая будет использоваться вместе с этим ключевым словом

![operator.png](../img/c1/operator.png)

Оператор SQL может состоять из множества условий, каждое из которых содержит по крайней мере одно ключевое слово, а также
ссылки на поля и таблицы.